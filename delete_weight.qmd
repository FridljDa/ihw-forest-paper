---
title: "delete_weight"
format: html
editor: visual
---

```{r}
library("dplyr")
```

```{r}
load(here::here("boca_leek/20230220_boca_leel_environment.RData"))
```

```{r}
df_weights_quantile <- ihw_quantile_n_maf@df %>%
  filter(fold == 1) %>%
  dplyr::select(weight, covariate.1, covariate.2, fold)
```

```{r}
data("diabetes", package = "rrcov")
head(diabetes)
options(bitmapType ="cairo")
```

```{r}
library("reshape2")
library("ggplot2")
```

```{r}
ggdb = ggplot(data = df_weights_quantile, mapping = aes(x = covariate.1, y = covariate.2)) 
```

```{r}
make1Dgrid = function(x) {
  rg = grDevices::extendrange(x)
  seq(from = rg[1], to = rg[2], length.out = 100)
}
```

```{r}
ihw_grid = with(df_weights_quantile,
  expand.grid(covariate.1 = make1Dgrid(covariate.1),
              covariate.2 = make1Dgrid(covariate.2)))
```

```{r}
library("caret")
ihw_rf_default <- train(weight ~ covariate.1 + covariate.2, 
                      data=df_weights_quantile, 
                      method='rf')
```

```{r}
ihw_grid$ghat <- predict(ihw_rf_default, newdata = ihw_grid)
```

```{r}
ggdb + geom_raster(aes(fill = ghat),
            data = ihw_grid, alpha = 0.25, interpolate = TRUE) +
    scale_x_continuous(expand = c(0, 0)) +
    scale_y_continuous(expand = c(0, 0))
```
