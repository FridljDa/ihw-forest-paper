---
title: "analyse relationship between p-values and maf"
author: "Danie Fridljand"
output: bookdown::html_document2
fig_width: 6 #TODO
---

```{r setup, include=FALSE}
library(ggplot2)
library(here)
library(dplyr)
library(IHW)
library("ggpubr")

knitr::opts_chunk$set(echo = TRUE, dpi = 40)
#knitr::include_graphics()
options(bitmapType ="cairo")
```


## data set 1
```{r}
chr <- 21
```

```{r}
chr_pvalues_grubert <- fst::read.fst("chr_pvalues_grubert_chr21.fst")
head(chr_pvalues_grubert)
#write.table(chr_pvalues_grubert, "chr_pvalues_grubert.txt")
#write.csv(chr_pvalues_grubert, "chr_pvalues_grubert.csv")
```


# IHW

```{r}
m_groups <- table(chr_pvalues_grubert$maf_sample_bin)
m = sum(m_groups)
```

```{r}
chr_pvalues_grubert_filtered <- chr_pvalues_grubert %>% filter(pvalue <= 10^(-1))
```

```{r}
chr_pvalues_grubert_p_adjust <- p.adjust(chr_pvalues_grubert_filtered$pvalue, n=m, method = "BH")
sum(chr_pvalues_grubert_p_adjust <= 0.05)
```


```{r}
ihw_maf_equal <- ihw(chr_pvalues_grubert_filtered$pvalue, chr_pvalues_grubert_filtered$maf_sample_bin, alpha = 0.05, m_groups=m_groups, lambdas=Inf, nfolds = 3)
rejections(ihw_maf_equal)
```
